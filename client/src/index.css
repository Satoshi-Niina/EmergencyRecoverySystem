@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
  }
}

@layer components {
  /* High contrast elements for nighttime use */
  .night-form {
    @apply bg-blue-50 border-2 border-primary shadow-md;
  }
  
  .night-text {
    @apply text-primary font-medium;
  }
  
  .night-button {
    @apply bg-primary hover:bg-primary/90 text-white font-bold shadow-lg;
  }
  
  .night-input {
    @apply bg-white border-2 border-blue-300 focus:border-primary text-zinc-900 placeholder:text-zinc-500;
  }
  
  .night-label {
    @apply text-primary-foreground font-semibold;
  }
  
  /* Enhanced visibility for camera elements */
  .camera-button {
    @apply bg-primary hover:bg-primary/90 text-white w-16 h-16 rounded-full flex items-center justify-center shadow-lg;
  }
  
  .camera-controls {
    @apply bg-black/80 text-white p-4 rounded-lg shadow-lg;
  }
  
  /* スライダーのための特別なスタイル */
  .search-panel-visible {
    transform: none !important;
  }
}

  /* すべての画面サイズに対する基本設定 */
  html, body, #root {
    min-height: 100%;
    width: 100%;
    height: 100%;
    max-width: 100vw;
    overflow: auto !important;
    -webkit-overflow-scrolling: touch;
  }
  
  body {
    position: relative !important;
    -webkit-overflow-scrolling: touch;
    overflow-x: auto !important;
    overflow-y: auto !important;
    touch-action: manipulation; /* タッチ操作の改善 */
  }
  
  /* 横スクロール可能なコンテナの共通設定 */
  .overflow-scroll-container {
    overflow-x: auto !important;
    overflow-y: auto !important;
    min-width: 320px;
    width: 100%;
  }
  
  /* 検索結果関連のスタイル */
  .search-results-container {
    max-height: 90vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  /* 検索結果のスライダー */
  #mobile-search-slider {
    display: block !important;
    z-index: 100 !important;
  }
  
  /* iOS Safari対応のスタイル */
  @supports (-webkit-touch-callout: none) {
    /* iOSデバイス向けの追加スタイル */
    .chat-messages-container {
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
    
    /* 縦向き時の検索結果パネル - 下から上へのスライド */
    .portrait-search-panel {
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      width: 100% !important;
      height: 70vh !important;
      transform: translateY(100%) !important;
      transition: transform 0.3s ease-in-out !important;
      z-index: 100 !important;
      background-color: #eff6ff !important;
      border-top-left-radius: 16px !important;
      border-top-right-radius: 16px !important;
    }
    
    /* 横向き時の検索結果パネル - 右から左へのスライド */
    .landscape-search-panel {
      position: fixed !important;
      top: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 40% !important;
      transform: translateX(100%) !important;
      transition: transform 0.3s ease-in-out !important;
      z-index: 100 !important;
      background-color: #eff6ff !important;
      border-left: 1px solid #bfdbfe !important;
    }
    
    /* 検索結果が表示されている状態 */
    .search-panel-visible {
      transform: translateY(0) !important;
      transform: translateX(0) !important;
    }
  }
  
  /* すべての画面サイズで適用される横スクロール対応 */
  @media screen and (max-width: 740px) {
    body {
      overflow-x: auto !important;
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
    .chat-layout-container {
      min-width: 320px;
      max-width: none;
      overflow-x: visible !important;
    }
    
    /* モバイル向け検索ボタン */
    .mobile-search-button {
      position: fixed !important;
      z-index: 101 !important;
    }
  }
  
  /* iPhoneの横向き表示に対する特別な対応 */
  @media screen and (orientation: landscape) and (max-height: 450px) {
    body, html, #root {
      width: 100%;
      min-height: 100%;
      overflow-x: auto !important;
      overflow-y: auto !important;
    }
    
    .chat-layout-container {
      width: 100% !important;
      min-width: 100% !important;
      overflow-x: auto !important;
      display: flex !important;
      flex-direction: row !important;
    }
  }
  
  /* iOS/iPhoneのための特別な対応 */
  @supports (-webkit-touch-callout: none) {
    html, body {
      height: -webkit-fill-available;
      overflow-x: auto !important;
      min-height: -webkit-fill-available;
      overflow-y: auto !important;
      width: 100vw;
    }
    #root {
      min-height: -webkit-fill-available;
      width: 100vw;
      overflow-x: auto !important;
    }
  }
  
  /* シンプルなモバイル対応スタイル */
  @media screen and (max-width: 768px) {
    /* 横スクロールを許可 */
    html, body, #root {
      overflow-x: auto !important;
      -webkit-overflow-scrolling: touch;
    }
    
    /* 横向き時のスタイル */
    @media screen and (orientation: landscape) {
      #mobile-search-slider {
        max-height: 80vh !important;
        width: 100% !important;
      }
      
      .mobile-search-button {
        bottom: 10px !important;
        right: 10px !important;
        z-index: 60 !important;
      }
    }
  }
  
  /* モバイル横向き用のスタイル */
  @media screen and (orientation: landscape) and (max-height: 600px) {
    html, body, #root {
      overflow-x: auto !important;
      overflow-y: auto !important;
      width: 100%;
      min-width: 100%;
      min-height: 100%;
      max-height: none !important;
    }
    
    /* 横向き時のチャットレイアウト調整 */
    .chat-layout-container {
      display: flex !important;
      flex-direction: row !important;
      min-height: 100vh;
      width: 100%;
      min-width: 100%;
      overflow-x: auto !important;
      overflow-y: auto !important;
    }
    
    .chat-messages-container {
      width: 60% !important;
      min-height: 100vh;
      overflow-y: auto !important;
      overflow-x: visible !important;
      min-width: 60% !important; /* 最小幅を設定 */
    }
    
    .chat-controls-container {
      width: 40% !important;
      display: flex;
      flex-direction: column;
      min-width: 40% !important; /* 最小幅を設定 */
    }
    
    /* 横向き時の検索結果パネル */
    #mobile-search-slider {
      width: 40% !important;
      right: 0 !important;
      left: auto !important;
      top: 0 !important;
      bottom: 0 !important;
      height: 100vh !important;
      transform: translateX(100%) !important;
      transition: transform 0.3s ease-in-out !important;
      border-left: 1px solid #bfdbfe;
      border-top: none !important;
      border-radius: 0 !important;
      position: fixed !important;
      max-height: 100vh !important;
      z-index: 1000 !important;
    }
    
    #mobile-search-slider[style*="transform: none"] {
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
    }
    
    /* モバイル横向き時のヘッダー調整 */
    .mobile-landscape-header {
      position: sticky;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 50;
      background-color: rgba(255, 255, 255, 0.95);
    }
    
    /* 検索結果の横スクロール対応 */
    .search-results-container {
      overflow-x: auto !important; 
      white-space: nowrap;
      min-width: 320px;
    }
    
    /* カメラモーダルのサイズ調整 */
    .camera-modal {
      max-width: 90vw !important;
      max-height: 80vh !important;
    }
    
    /* メッセージ入力エリアの調整 */
    .message-input-container {
      position: sticky;
      bottom: 0;
      width: 100%;
    }
  }
  
  /* スライダーのための特別なスタイル */
  .search-panel-visible {
    transform: none !important;
  }